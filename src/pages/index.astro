---
import BaseLayout from "../layouts/BaseLayout.astro";
import Hero from "../components/Hero.astro";
import ProjectCard from "../components/ProjectCard.astro";
import BlogPostCard from "../components/BlogPostCard.astro";
import { getCollection } from "astro:content";

const featuredProjects = (await getCollection("projects"))
  .filter((p) => p.data.featured)
  .sort((a, b) => a.data.sortOrder - b.data.sortOrder);

const recentPosts = (await getCollection("blog", ({ data }) => !data.draft))
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .slice(0, 3);
---

<BaseLayout
  title="Sung Woo Hwang â€” Software Developer"
  description="Portfolio and blog by Sung Woo Hwang. I build software that solves real problems."
>
  <Hero />

  <!-- Featured Projects -->
  <section class="max-w-5xl mx-auto px-6 py-16">
    <div class="flex items-center justify-between mb-8">
      <h2
        class="text-2xl font-bold text-surface-900 dark:text-surface-100 tracking-tight"
      >
        Featured Projects
      </h2>
      <a
        href="/projects"
        class="text-sm font-medium text-accent-600 dark:text-accent-400 hover:text-accent-700 dark:hover:text-accent-500 transition-colors"
      >
        View all &rarr;
      </a>
    </div>
    <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
      {featuredProjects.map((project) => <ProjectCard project={project} />)}
    </div>
  </section>

  <!-- Recent Blog Posts -->
  <section class="max-w-3xl mx-auto px-6 py-16">
    <div class="flex items-center justify-between mb-8">
      <h2
        class="text-2xl font-bold text-surface-900 dark:text-surface-100 tracking-tight"
      >
        Recent Posts
      </h2>
      <a
        href="/blog"
        class="text-sm font-medium text-accent-600 dark:text-accent-400 hover:text-accent-700 dark:hover:text-accent-500 transition-colors"
      >
        View all &rarr;
      </a>
    </div>
    <div class="divide-y divide-surface-200 dark:divide-surface-800">
      {recentPosts.map((post) => <BlogPostCard post={post} />)}
    </div>
  </section>
</BaseLayout>
